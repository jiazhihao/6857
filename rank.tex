\section{Ranking}
\label{s:rank}

\sys may report many potential errors.  We are only interested
in high-risk ones.  We consider an integer error as high risk if the
result is either computed based on untrusted inputs, or used in
sensitive sinks.  Such inputs and sinks are generally specific to
the system being analyzed.  This section discuss them in the context
of the Linux kernel.

\subsection{Untrusted inputs}
\label{s:rank:input}

Untrusted inputs are all channels into the kernel from the outside world,
including data copied from user space (via system calls, virtual file
systems like \cc{sysfs}, or kernel functions like \cc{copy_from_user}),
received from the network, and read from disks. The kernel usually needs to
perform sanity checks before using them. 

In general, kernel developers trust hardware devices. Thus, \sys
excludes the I/O response of hardware devices from untrusted inputs,
with the exception of USB devices.  Recent research has demonstrated
how to develop a malicious USB device to plug in a Linux box and
exploit the kernel~\cite{usb:buffer-overflow}.

\sys propagates untrusted inputs across functions using an iterative algorithm
similar to what we discussed in Section \ref{s:gen:range}. We manually annotate
taint sources for the Linux kernel, which include system call arguments, the
destination argument of \cc{copy_from_user} and \cc{get_user}. For network,
file systems and USB drivers, the return values of endian conversion functions
(e.g. \cc{be32_to_cpu}) are also marked as taint sources because the
converting values are likely to originate from network or disk.


%Two most notable error-prone channels are \cc{ioctl} and \cc{setsockopt},
%due to their infamous irregular interfaces and pervading implementations
%in device drivers and network protocols.  \sys pays special attention
%to integer errors that could happen in their calling context.
%\nz{What does "in their calling context" mean?}
%\nz{What does "pays special attention" mean?}


\subsection{Sensitive Sinks}

Sensitive sinks include sizes for memory allocation, data moving and I/O
communication. For example, an erroneous integer value used in the size
argument of \cc{kmalloc}, \cc{copy_to_user} or \cc{sock_alloc_send_skb}
is more likely to damage the system, yielding memory corruption or 
information leakage.  Currently we have 41 annotations for these sensitive
sinks for the Linux kernel.

Another category of sensitive sinks are branch conditions. Control flow
decisions based on the outcome of buggy integer operations are prone to cause
logical errors. \sys highlights these errors in its report as well.

