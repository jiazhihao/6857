\begin{Verbatim}[commandchars=\\\{\},codes={\catcode`\$=3\catcode`\^=7\catcode`\_=8}]
\PY{c+cm}{/* overflow checks for}
\PY{c+cm}{ *   maxmsg * msgsize + maxmsg * sizeof(void *)}
\PY{c+cm}{ * assume}
\PY{c+cm}{ *   0 < maxmsg $\leq$ $2^{15}$}
\PY{c+cm}{ *   0 < msgsize $<$ $2^{31}$}
\PY{c+cm}{ */}
\PY{k}{if} \PY{p}{(}\PY{n}{msgsize} \PY{o}{>} \PY{n}{ULONG\PYZus{}MAX} \PY{o}{/} \PY{n}{maxmsg}\PY{p}{)}
    \PY{k}{return} \PY{l+m+mi}{0}\PY{p}{;}
\PY{k}{if} \PY{p}{(}\PY{n}{maxmsg} \PY{o}{*} \PY{p}{(}\PY{n}{msgsize} \PY{o}{+} \PY{k}{sizeof}\PY{p}{(}\PY{k+kt}{void} \PY{o}{*}\PY{p}{)}\PY{p}{)}
    \PY{o}{<} \PY{n}{maxmsg} \PY{o}{*} \PY{n}{msgsize}\PY{p}{)}
    \PY{k}{return} \PY{l+m+mi}{0}\PY{p}{;}
\PY{k}{return} \PY{l+m+mi}{1}\PY{p}{;}
\end{Verbatim}
