\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kt}{unsigned} \PY{k+kt}{long} \PY{n}{maxnum0} \PY{o}{=} \PY{p}{.}\PY{p}{.}\PY{p}{.}\PY{p}{;} \PY{c+cm}{/* read from userspace */} 
\PY{k+kt}{size\PYZus{}t} \PY{n}{size}\PY{p}{;}
\PY{c+cm}{/* limit to 256 = 4096 / 16 */}
\PY{k}{if} \PY{p}{(}\PY{n}{maxnum0} \PY{o}{>} \PY{n}{PAGE\PYZus{}SIZE} \PY{o}{/} \PY{k}{sizeof}\PY{p}{(}\PY{k}{struct} \PY{n}{\PYZus{}\PYZus{}fdb\PYZus{}entry}\PY{p}{)}\PY{p}{)}
    \PY{n}{maxnum1} \PY{o}{=} \PY{n}{PAGE\PYZus{}SIZE} \PY{o}{/} \PY{k}{sizeof}\PY{p}{(}\PY{k}{struct} \PY{n}{\PYZus{}\PYZus{}fdb\PYZus{}entry}\PY{p}{)}\PY{p}{;}
\PY{k}{else}
    \PY{n}{maxnum1} \PY{o}{=} \PY{n}{maxnum0}\PY{p}{;}
\PY{n}{size} \PY{o}{=} \PY{n}{maxnum1} \PY{o}{*} \PY{k}{sizeof}\PY{p}{(}\PY{k}{struct} \PY{n}{\PYZus{}\PYZus{}fdb\PYZus{}entry}\PY{p}{)}\PY{p}{;}
\PY{n}{buf} \PY{o}{=} \PY{n}{kmalloc}\PY{p}{(}\PY{n}{size}\PY{p}{,} \PY{n}{GFP\PYZus{}USER}\PY{p}{)}\PY{p}{;}
\end{Verbatim}
